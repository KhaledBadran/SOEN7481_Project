{
    "functionName": "test_mcmc_helper_target_function_unconstrained",
    "className": null,
    "fileName": "/GPflow_&_GPflow/tests_&_gpflow_&_optimizers_&_test_mcmc.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "\"\"\" Verifies the objective for a set of priors which are defined on the unconstrained space.\n    \"\"\"\ndata = build_data()\nmodel = build_model(data)\nexpected_log_prior = 0.0\nprior_width = 200.0\nhmc_helper = gpflow.optimizers.SamplingHelper(model.log_posterior_density,\n    model.trainable_parameters)\nfor param in model.trainable_parameters:\n    low_value = -100\n    high_value = low_value + prior_width\n    param.prior = Uniform(low=np.float64(low_value), high=np.float64(\n        high_value))\n    param.prior_on = 'unconstrained'\n    prior_density = 1 / prior_width\n    expected_log_prior += np.log(prior_density)\ntarget_log_prob_fn = hmc_helper.target_log_prob_fn\nexpected_log_prob = model.log_marginal_likelihood().numpy(\n    ) + expected_log_prior\nnp.testing.assert_allclose(target_log_prob_fn(), expected_log_prob)\n"
}