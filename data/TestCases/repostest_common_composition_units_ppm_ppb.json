{
    "functionName": "test_common_composition_units_ppm_ppb",
    "className": "TestCommonProperties",
    "fileName": "/pr-omethe-us_&_PyKED/pyked_&_tests_&_test_converters.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "\"\"\"Test proper handling of common composition unit conversion for ppm and ppb.\n        \"\"\"\nroot = etree.Element('experiment')\nproperties = etree.SubElement(root, 'commonProperties')\ninitial_composition = etree.SubElement(properties, 'property')\ninitial_composition.set('name', 'initial composition')\nspecies_refs = [{'name': 'H2', 'inchi': '1S/H2/h1H', 'amount': 100, 'units':\n    'ppb'}, {'name': 'O2', 'inchi': '1S/O2/c1-2', 'amount': 10, 'units':\n    'ppm'}, {'name': 'Ar', 'inchi': '1S/Ar', 'amount': 0.999985, 'units':\n    'mole fraction'}]\nfor spec in species_refs:\n    component = etree.SubElement(initial_composition, 'component')\n    species = etree.SubElement(component, 'speciesLink')\n    species.set('preferredKey', spec['name'])\n    species.set('InChI', spec['inchi'])\n    amount = etree.SubElement(component, 'amount')\n    amount.set('units', spec['units'])\n    amount.text = str(spec['amount'])\nwith pytest.warns(UserWarning) as record:\n    common = get_common_properties(root)\nm = str(record.pop(UserWarning).message)\nassert m == 'Assuming molar ppb in composition and converting to mole fraction'\nm = str(record.pop(UserWarning).message)\nassert m == 'Assuming molar ppm in composition and converting to mole fraction'\nassert common['composition']['kind'] == 'mole fraction'\nassert len(common['composition']['species']) == 3\nassert common['composition']['species'][0]['species-name'] == 'H2'\nassert common['composition']['species'][0]['InChI'] == '1S/H2/h1H'\nassert_allclose(common['composition']['species'][0]['amount'], [1e-07])\nassert common['composition']['species'][1]['species-name'] == 'O2'\nassert common['composition']['species'][1]['InChI'] == '1S/O2/c1-2'\nassert_allclose(common['composition']['species'][1]['amount'], [1e-05])\nassert common['composition']['species'][2]['species-name'] == 'Ar'\nassert common['composition']['species'][2]['InChI'] == '1S/Ar'\nassert_allclose(common['composition']['species'][2]['amount'], [0.999985])\n"
}