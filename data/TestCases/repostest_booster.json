{
    "functionName": "test_booster",
    "className": null,
    "fileName": "/microsoft_&_LightGBM/tests_&_c_api_test_&_test_.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "train = load_from_mat(os.path.join(os.path.dirname(os.path.realpath(\n    __file__)), '../../examples/binary_classification/binary.train'), None)\ntest = load_from_mat(os.path.join(os.path.dirname(os.path.realpath(__file__\n    )), '../../examples/binary_classification/binary.test'), train)\nbooster = ctypes.c_void_p()\nLIB.LGBM_BoosterCreate(train, c_str(\n    'app=binary metric=auc num_leaves=31 verbose=0'), ctypes.byref(booster))\nLIB.LGBM_BoosterAddValidData(booster, test)\nis_finished = ctypes.c_int(0)\nfor i in range(1, 51):\n    LIB.LGBM_BoosterUpdateOneIter(booster, ctypes.byref(is_finished))\n    result = np.array([0.0], dtype=np.float64)\n    out_len = ctypes.c_ulong(0)\n    LIB.LGBM_BoosterGetEval(booster, 0, ctypes.byref(out_len), result.\n        ctypes.data_as(ctypes.POINTER(ctypes.c_double)))\n    if i % 10 == 0:\n        print('%d iteration test AUC %f' % (i, result[0]))\nLIB.LGBM_BoosterSaveModel(booster, 0, -1, 0, c_str('model.txt'))\nLIB.LGBM_BoosterFree(booster)\nfree_dataset(train)\nfree_dataset(test)\nbooster2 = ctypes.c_void_p()\nnum_total_model = ctypes.c_long()\nLIB.LGBM_BoosterCreateFromModelfile(c_str('model.txt'), ctypes.byref(\n    num_total_model), ctypes.byref(booster2))\ndata = []\nwith open(os.path.join(os.path.dirname(os.path.realpath(__file__)),\n    '../../examples/binary_classification/binary.test'), 'r') as inp:\n    for line in inp.readlines():\n        data.append([float(x) for x in line.split('\\t')[1:]])\nmat = np.array(data)\npreb = np.zeros(mat.shape[0], dtype=np.float64)\nnum_preb = ctypes.c_long()\ndata = np.array(mat.reshape(mat.size), copy=False)\nLIB.LGBM_BoosterPredictForMat(booster2, data.ctypes.data_as(ctypes.POINTER(\n    ctypes.c_void_p)), dtype_float64, mat.shape[0], mat.shape[1], 1, 1, 0, \n    25, c_str(''), ctypes.byref(num_preb), preb.ctypes.data_as(ctypes.\n    POINTER(ctypes.c_double)))\nLIB.LGBM_BoosterPredictForFile(booster2, c_str(os.path.join(os.path.dirname\n    (os.path.realpath(__file__)),\n    '../../examples/binary_classification/binary.test')), 0, 0, 0, 25,\n    c_str(''), c_str('preb.txt'))\nLIB.LGBM_BoosterPredictForFile(booster2, c_str(os.path.join(os.path.dirname\n    (os.path.realpath(__file__)),\n    '../../examples/binary_classification/binary.test')), 0, 0, 10, 25,\n    c_str(''), c_str('preb.txt'))\nLIB.LGBM_BoosterFree(booster2)\n"
}