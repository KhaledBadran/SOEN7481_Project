{
    "functionName": "test_cudnn_lstm_save_and_cudnn_compatible_load",
    "className": "TestTFLayers",
    "fileName": "/deepmipt_&_DeepPavlov/tests_&_test_tf_layers.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "x = np.random.normal(size=(10, 10, 50))\ntf.reset_default_graph()\ncdnnlstmmodel = DPCudnnLSTMModel(num_layers=num_layers, num_units=100)\nbefore_load_hidden, before_load_state = cdnnlstmmodel(x)[0], cdnnlstmmodel(x)[1\n    ]\ncdnnlstmmodel.save(str(tf_layers_data_path / 'dpcudnnlstmmodel' / 'model'))\ntf.reset_default_graph()\ncdnnlstmmodel = DPLSTMModel(num_layers=num_layers, num_units=100)\ncdnnlstmmodel.load(str(tf_layers_data_path / 'dpcudnnlstmmodel' / 'model'))\nafter_load_hidden, after_load_state = cdnnlstmmodel(x)[0], cdnnlstmmodel(x)[1]\nequal_hidden = self.equal_values(after_load_hidden, before_load_hidden)\nequal_state = self.equal_values(after_load_state, before_load_state)\nassert equal_hidden > 1 - self.allowed_error_lvl\nassert equal_state > 1 - self.allowed_error_lvl\npytest.mark.parametrize('num_layers', [1, 3])"
}