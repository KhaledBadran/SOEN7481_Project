{
    "functionName": "taylor_aris_diffusion",
    "className": null,
    "fileName": "/pmeal_&_OpenPNM/openpnm_&_models_&_physics_&_diffusive_conductance.py",
    "projectName": "repos",
    "Label": false,
    "isTest": false,
    "Body": "\"\"\"\n    Calculate the diffusive conductance of conduits in network considering the\n    Taylor-Aris effect (effect of fluid flow on diffusion), where a\n    conduit is ( 1/2 pore - full throat - 1/2 pore ). See the notes section.\n\n    Parameters\n    ----------\n    target : OpenPNM Object\n        The object which this model is associated with. This controls the\n        length of the calculated array, and also provides access to other\n        necessary properties.\n\n    pore_area : string\n        Dictionary key of the pore area values\n\n    throat_area : string\n        Dictionary key of the throat area values\n\n    pore_diffusivity : string\n        Dictionary key of the pore diffusivity values\n\n    pore_pressure : string\n        Dictionary key of the pore pressure values\n\n    throat_hydraulic_conductance : string\n        Dictionary key of the throat hydraulic_conductance values\n\n    throat_diffusivity : string\n        Dictionary key of the throat diffusivity values\n\n    conduit_lengths : string\n        Dictionary key of the conduit length values\n\n    conduit_shape_factors : string\n        Dictionary key of the conduit DIFFUSION shape factor values\n\n    Returns\n    -------\n    g : ndarray\n        Array containing diffusive conductance values (with Taylor-Aris effect)\n        for conduits in the geometry attached to the given physics object.\n\n    Notes\n    -----\n    (1) This function requires that all the necessary phase properties are\n    already calculated.\n\n    (2) This function calculates the specified property for the *entire*\n    network then extracts the values for the appropriate throats at the end.\n\n    (3) This function assumes cylindrical throats with constant cross-section\n    area. Corrections for different shapes and variable cross-section area can\n    be imposed by passing the proper conduit_shape_factors argument.\n\n    (4) shape_factor depends on the physics of the problem, i.e. diffusion-like\n    processes and fluid flow need different shape factors.\n\n    \"\"\"\nnetwork = target.project.network\nthroats = network.map_throats(throats=target.Ts, origin=target)\nphase = target.project.find_phase(target)\ncn = network['throat.conns'][throats]\nA1 = network[pore_area][cn[:, (0)]]\nAt = network[throat_area][throats]\nA2 = network[pore_area][cn[:, (1)]]\nL1 = network[conduit_lengths + '.pore1'][throats]\nLt = network[conduit_lengths + '.throat'][throats]\nL2 = network[conduit_lengths + '.pore2'][throats]\ntry:\n    SF1 = phase[conduit_shape_factors + '.pore1'][throats]\n    SFt = phase[conduit_shape_factors + '.throat'][throats]\n    SF2 = phase[conduit_shape_factors + '.pore2'][throats]\nexcept KeyError:\n    SF1 = SF2 = SFt = 1.0\nD1, D2 = phase[pore_diffusivity][cn].T\nDt = phase.interpolate_data(propname=pore_diffusivity)[throats]\nP = phase[pore_pressure]\ngh = phase[throat_hydraulic_conductance]\nQt = -gh * _np.diff(P[cn], axis=1).squeeze()\nu1 = Qt / A1\nu2 = Qt / A2\nut = Qt / At\nPe1 = u1 * (4 * A1 / _np.pi) ** 0.5 / D1\nPe2 = u2 * (4 * A2 / _np.pi) ** 0.5 / D2\nPet = ut * (4 * At / _np.pi) ** 0.5 / Dt\ng1 = D1 * (1 + Pe1 ** 2 / 192) * A1 / L1\ng2 = D2 * (1 + Pe2 ** 2 / 192) * A2 / L2\ngt = Dt * (1 + Pet ** 2 / 192) * At / Lt\ng1[L1 == 0] = _np.inf\ng2[L2 == 0] = _np.inf\ngt[Lt == 0] = _np.inf\nreturn (1 / gt / SFt + 1 / g1 / SF1 + 1 / g2 / SF2) ** -1\n"
}