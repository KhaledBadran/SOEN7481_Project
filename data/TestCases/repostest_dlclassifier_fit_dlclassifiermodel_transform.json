{
    "functionName": "test_dlclassifier_fit_dlclassifiermodel_transform",
    "className": "TestDLClassifer",
    "fileName": "/intel-analytics_&_Bigdl/pyspark_&_test_&_bigdl_&_dlframes_&_test_dl_classifier.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "model = Sequential().add(Linear(2, 2))\ncriterion = ClassNLLCriterion()\nclassifier = DLClassifier(model, criterion, [2]).setBatchSize(4\n    ).setLearningRate(0.01).setMaxEpoch(1000)\ndata = self.sc.parallelize([((2.0, 1.0), 1.0), ((1.0, 2.0), 2.0), ((2.0, \n    1.0), 1.0), ((1.0, 2.0), 2.0)])\nschema = StructType([StructField('features', ArrayType(DoubleType(), False),\n    False), StructField('label', DoubleType(), False)])\ndf = self.sqlContext.createDataFrame(data, schema)\ndlClassifierModel = classifier.fit(df)\nres = dlClassifierModel.transform(df)\nassert type(res).__name__ == 'DataFrame'\nres.registerTempTable('dlClassifierModelDF')\nresults = self.sqlContext.table('dlClassifierModelDF')\ncount = results.rdd.count()\ndata = results.rdd.collect()\nfor i in range(count):\n    row_label = data[i][1]\n    row_prediction = data[i][2]\n    assert row_label == row_prediction\n"
}