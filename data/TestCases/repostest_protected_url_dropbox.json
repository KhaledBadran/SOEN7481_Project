{
    "functionName": "test_protected_url_dropbox",
    "className": "TestCase",
    "fileName": "/IntegralDefense_&_ACE/lib_&_saq_&_modules_&_test_url.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "root = create_root_analysis()\nroot.initialize_storage()\nurl_with_dl0 = root.add_observable(F_URL,\n    'https://www.dropbox.com/s/ezdhsvdxf6wrxk6/RFQ-012018-000071984-13-Rev.1.zip?dl=0'\n    )\nurl_with_dl1 = root.add_observable(F_URL,\n    'https://www.dropbox.com/s/ezdhsvdxf6wrxk6/RFQ-012018-000071984-13-Rev.1.zip?dl=1'\n    )\nurl_without_dl = root.add_observable(F_URL,\n    'https://www.dropbox.com/s/ezdhsvdxf6wrxk6/RFQ-012018-000071984-13-Rev.1.zip'\n    )\nurl_with_dl0.add_directive(DIRECTIVE_CRAWL)\nurl_with_dl1.add_directive(DIRECTIVE_CRAWL)\nurl_without_dl.add_directive(DIRECTIVE_CRAWL)\nroot.save()\nroot.schedule()\nengine = TestEngine()\nengine.enable_module('analysis_module_protected_url_analyzer', 'test_groups')\nengine.controlled_stop()\nengine.start()\nengine.wait()\nroot.load()\nurl_with_dl0 = root.get_observable(url_with_dl0.id)\nurl_with_dl1 = root.get_observable(url_with_dl1.id)\nurl_without_dl = root.get_observable(url_without_dl.id)\nfrom saq.modules.url import ProtectedURLAnalysis, PROTECTION_TYPE_DROPBOX\nanalysis = url_with_dl0.get_analysis(ProtectedURLAnalysis)\nself.assertIsNotNone(analysis)\nself.assertEquals(analysis.protection_type, PROTECTION_TYPE_DROPBOX)\nself.assertEquals(analysis.extracted_url,\n    'https://www.dropbox.com/s/ezdhsvdxf6wrxk6/RFQ-012018-000071984-13-Rev.1.zip?dl=1'\n    )\nextracted_url = analysis.get_observables_by_type(F_URL)\nself.assertEquals(len(extracted_url), 1)\nextracted_url = extracted_url[0]\nself.assertTrue(extracted_url.has_directive(DIRECTIVE_CRAWL))\nanalysis = url_with_dl1.get_analysis(ProtectedURLAnalysis)\nself.assertFalse(analysis)\nanalysis = url_without_dl.get_analysis(ProtectedURLAnalysis)\nself.assertIsNotNone(analysis)\nself.assertEquals(analysis.protection_type, PROTECTION_TYPE_DROPBOX)\nself.assertEquals(analysis.extracted_url,\n    'https://www.dropbox.com/s/ezdhsvdxf6wrxk6/RFQ-012018-000071984-13-Rev.1.zip?dl=1'\n    )\nextracted_url = analysis.get_observables_by_type(F_URL)\nself.assertEquals(len(extracted_url), 1)\nextracted_url = extracted_url[0]\nself.assertTrue(extracted_url.has_directive(DIRECTIVE_CRAWL))\n"
}