{
    "functionName": "test_integration_prepare_protein",
    "className": null,
    "fileName": "/Merck_&_DeepBGC/test_&_integration_&_commands_&_test_integration_prepare.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "tmpdir = str(tmpdir)\noutgbk = os.path.join(tmpdir, 'outfile.gbk')\nouttsv = os.path.join(tmpdir, 'outfile.tsv')\nrun(['prepare', '--protein', '--output-gbk', outgbk, '--output-tsv', outtsv,\n    get_test_file('BGC0000015.protein.fa')])\nrecords = list(SeqIO.parse(outgbk, 'genbank'))\nassert len(records) == 1\nrecord = records[0]\nassert_sorted_features(record)\nproteins = util.get_protein_features(record)\npfams = util.get_pfam_features(record)\nassert len(proteins) == 30\nprint([util.get_protein_id(f) for f in proteins])\nassert len(pfams) == 155\ndomains = pd.read_csv(outtsv, sep='\\t')\nrecords = domains.groupby('sequence_id')\nassert len(records) == 1\nrecord = records.get_group('BGC0000015.protein')\nprint(record['protein_id'].unique())\nassert len(record['protein_id'].unique()) == 30\nassert len(record) == 155\n"
}