{
    "functionName": "test_prepare_json",
    "className": null,
    "fileName": "/OpenSCAP_&_OVAL-visualization-as-graph/tests_&_test_arf_to_json.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "src = 'test_data/ssg-fedora-ds-arf.xml'\nrule = 'xccdf_org.ssgproject.content_rule_package_abrt_removed'\nclient = get_client_arf_to_json(src, rule)\nrules = {'rules': [rule]}\ndate = str(datetime.now().strftime('-%d_%m_%Y-%H_%M_%S'))\nresults_src = client.prepare_data(rules)\nassert not results_src\ncaptured = capsys.readouterr()\nassert captured.out == \"\"\"{\n    \"graph-of-xccdf_org.ssgproject.content_rule_package_abrt_removed\"\"\" + date + \"\"\"\": {\n        \"node_id\": \"xccdf_org.ssgproject.content_rule_package_abrt_removed\",\n        \"type\": \"operator\",\n        \"value\": \"and\",\n        \"negation\": false,\n        \"comment\": \"Package abrt Removed\",\n        \"tag\": \"Rule\",\n        \"test_result_details\": null,\n        \"child\": [\n            {\n                \"node_id\": \"oval:ssg-package_abrt_removed:def:1\",\n                \"type\": \"operator\",\n                \"value\": \"and\",\n                \"negation\": false,\n                \"comment\": \"The RPM package abrt should be removed.\",\n                \"tag\": \"Definition\",\n                \"test_result_details\": null,\n                \"child\": [\n                    {\n                        \"node_id\": \"oval:ssg-test_package_abrt_removed:tst:1\",\n                        \"type\": \"value\",\n                        \"value\": \"false\",\n                        \"negation\": false,\n                        \"comment\": \"package abrt is removed\",\n                        \"tag\": \"Test\",\n                        \"test_result_details\": {\n                            \"id\": \"oval:ssg-test_package_abrt_removed:tst:1\",\n                            \"comment\": \"package abrt is removed\",\n                            \"objects\": [\n                                {\n                                    \"oval:ssg-obj_package_abrt_removed:obj:1\": \"complete\",\n                                    \"rpminfo_object\": {\n                                        \"name\": \"abrt\",\n                                        \"arch\": \"x86_64\",\n                                        \"epoch\": \"(none)\",\n                                        \"release\": \"2.fc30\",\n                                        \"version\": \"2.12.0\",\n                                        \"evr\": \"0:2.12.0-2.fc30\",\n                                        \"signature_keyid\": \"ef3c111fcfc659b9\",\n                                        \"extended_name\": \"abrt-0:2.12.0-2.fc30.x86_64\"\n                                    }\n                                }\n                            ]\n                        },\n                        \"child\": null\n                    }\n                ]\n            }\n        ]\n    }\n}\n\"\"\"\n"
}