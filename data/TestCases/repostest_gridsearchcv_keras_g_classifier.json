{
    "functionName": "test_gridsearchcv_keras_g_classifier",
    "className": null,
    "fileName": "/goeckslab_&_Galaxy-ML/galaxy_ml_&_tests_&_test_keras_galaxy.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "config = train_model.get_config()\nclassifier = KerasGClassifier(config, optimizer='adam', batch_size=32,\n    metrics=[], seed=42)\nparam_grid = dict(epochs=[60], batch_size=[20], lr=[0.003],\n    layers_1_Dense__config__kernel_initializer__config__seed=[999],\n    layers_0_Dense__config__kernel_initializer__config__seed=[999])\ncv = StratifiedKFold(n_splits=5)\ngrid = GridSearchCV(classifier, param_grid, cv=cv, scoring='accuracy',\n    refit=True, error_score='raise')\ngrid_result = grid.fit(X, y)\ngot1 = round(grid_result.best_score_, 2)\ngot2 = grid_result.best_estimator_.lr\ngot3 = grid_result.best_estimator_.epochs\ngot4 = grid_result.best_estimator_.batch_size\ngot5 = grid_result.best_estimator_.config['layers'][0]['config'][\n    'kernel_initializer']['config']['seed']\ngot6 = grid_result.best_estimator_.config['layers'][1]['config'][\n    'kernel_initializer']['config']['seed']\nprint(grid_result.best_score_)\nassert 0.68 <= got1 <= 0.72, got1\nassert got2 == 0.003, got2\nassert got3 == 60, got3\nassert got4 == 20, got4\nassert got5 == 999, got5\nassert got6 == 999, got6\n"
}