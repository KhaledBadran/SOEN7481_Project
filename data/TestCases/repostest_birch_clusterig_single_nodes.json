{
    "functionName": "test_birch_clusterig_single_nodes",
    "className": null,
    "fileName": "/FreeDiscovery_&_FreeDiscovery/freediscovery_&_tests_&_test_cluster.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "basename = os.path.dirname(__file__)\nX = np.load(os.path.join(basename, '..', 'data', 'ds_lsi_birch', 'data.npy'))\nbranching_factor = 5\nmod = Birch(n_clusters=None, threshold=0.1, branching_factor=\n    branching_factor, compute_labels=False, compute_sample_indices=True)\nmod.fit(X)\nhtree, n_subclusters = birch_hierarchy_wrapper(mod)\nfor row in htree.flatten():\n    inertia, S_sim = centroid_similarity(X, row['document_id_accumulated'])\n    row['document_similarity'] = S_sim\n    row['cluster_similarity'] = inertia\nassert htree.tree_size == n_subclusters\ndoc_count = 0\nfor el in htree.flatten():\n    doc_count += len(el['document_id'])\n    el.current_depth\n    el.document_id_accumulated\nassert doc_count == len(htree['document_id_accumulated'])\nassert doc_count == X.shape[0]\nassert htree.document_count == X.shape[0]\nassert sum(len(el.children) == 1 for el in htree.flatten()) == 0\n"
}