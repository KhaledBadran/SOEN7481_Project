{
    "functionName": "test_spiketiming_report",
    "className": null,
    "fileName": "/VisualNeuroscience-UH_&_CxSystem2/tests_&_test_python_array_clusterrun.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "spikes_all, new_spikes_all = get_spike_data\nkeys = list(spikes_all.keys())\ntime_resolution = 0.1 * msecond\ntime_vector_length = 2000\nwith capsys.disabled():\n    print('\\n')\nfor key in keys:\n    new_spikes_all[key]['N']\n    spikes_all[key]['N']\n    all_spiking_neurons = np.union1d(spikes_all[key]['i'], new_spikes_all[\n        key]['i'])\n    spikes_index_time_matrix = np.zeros([max(all_spiking_neurons) + 1, int(\n        time_vector_length)])\n    spikes_time_indeces_float = spikes_all[key]['t'] / time_resolution\n    spikes_index_time_matrix[spikes_all[key]['i'],\n        spikes_time_indeces_float.astype(int)] = 1\n    spikes_index_time_matrix = spikes_index_time_matrix[(\n        all_spiking_neurons), :]\n    new_spikes_index_time_matrix = np.zeros([max(all_spiking_neurons) + 1,\n        int(time_vector_length)])\n    new_spikes_time_indeces_float = new_spikes_all[key]['t'] / time_resolution\n    new_spikes_index_time_matrix[new_spikes_all[key]['i'],\n        new_spikes_time_indeces_float.astype(int)] = 1\n    new_spikes_index_time_matrix = new_spikes_index_time_matrix[(\n        all_spiking_neurons), :]\n    cumulative_ks = 0\n    cumulative_wd = 0\n    for idx, neuron_idx in enumerate(all_spiking_neurons):\n        spike_data = np.nonzero(spikes_index_time_matrix[(idx), :])[0]\n        new_spike_data = np.nonzero(new_spikes_index_time_matrix[(idx), :])[0]\n        ksstat = ks_2samp(spike_data, new_spike_data)\n        wass_dist = wasserstein_distance(spike_data, new_spike_data)\n        cumulative_ks += ksstat[0]\n        cumulative_wd += wass_dist\n    mean_ks = cumulative_ks / len(all_spiking_neurons)\n    mean_wd = time_resolution / msecond * cumulative_wd / len(\n        all_spiking_neurons)\n    with capsys.disabled():\n        print('Mean Wasserstein Distance (spike shift) for {0} is {1:.2f} ms'\n            .format(key, mean_wd))\n"
}