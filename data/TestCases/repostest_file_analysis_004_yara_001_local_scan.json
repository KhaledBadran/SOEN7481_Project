{
    "functionName": "test_file_analysis_004_yara_001_local_scan",
    "className": "TestCase",
    "fileName": "/IntegralDefense_&_ACE/lib_&_saq_&_modules_&_test_file_analysis.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "root = create_root_analysis(uuid=str(uuid.uuid4()))\nroot.initialize_storage()\nshutil.copy('test_data/scan_targets/match', root.storage_dir)\n_file = root.add_observable(F_FILE, 'match')\nroot.save()\nroot.schedule()\nengine = TestEngine()\nengine.enable_module('analysis_module_yara_scanner_v3_4', 'test_groups')\nengine.controlled_stop()\nengine.start()\nengine.wait()\nself.assertEquals(log_count('with yss (matches found: True)'), 0)\nself.assertEquals(log_count('failed to connect to yara socket server'), 1)\nself.assertEquals(log_count('initializing local yara scanner'), 1)\nself.assertEquals(log_count('got yara results for'), 1)\nroot.load()\n_file = root.get_observable(_file.id)\nfrom saq.modules.file_analysis import YaraScanResults_v3_4\nanalysis = _file.get_analysis(YaraScanResults_v3_4)\nself.assertTrue(analysis)\nself.assertTrue(_file.has_directive(DIRECTIVE_SANDBOX))\nself.assertEquals(len(_file.tags), 1)\nyara_rule = analysis.get_observables_by_type(F_YARA_RULE)\nself.assertEquals(len(yara_rule), 1)\nyara_rule = yara_rule[0]\nself.assertTrue(yara_rule.detections)\nunittest.skip"
}