{
    "functionName": "test_pressure_queries",
    "className": null,
    "fileName": "/AntoineToubhans_&_MongoTs/test_&_integration_test.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "actual_df = pressure_collection.query(*args, **kwargs)\nexpected_df = pd.DataFrame(index=expected['index'], columns=['count', 'min',\n    'max', 'mean', 'std'], data=expected['data'])\npd.testing.assert_frame_equal(actual_df, expected_df)\npytest.mark.parametrize('args, kwargs, expected', [((datetime(1996, 1, 1),\n    datetime(1996, 12, 31)), {'aggregateby': '1y'}, {'index': pd.Index([\n    datetime(1996, 1, 1)], name='datetime'), 'data': [[6348, 1001.0, 1074.2,\n    1015.427520478, 5.8321529378]]}), ((datetime(1996, 1, 1), datetime(1996,\n    12, 31)), {'aggregateby': '1m'}, {'index': pd.Index([datetime(1996, 1, \n    1), datetime(1996, 2, 1), datetime(1996, 3, 1), datetime(1996, 4, 1),\n    datetime(1996, 5, 1), datetime(1996, 6, 1), datetime(1996, 7, 1),\n    datetime(1996, 8, 1), datetime(1996, 9, 1), datetime(1996, 10, 1),\n    datetime(1996, 11, 1), datetime(1996, 12, 1)], name='datetime'), 'data':\n    [[0, np.inf, -np.inf, np.nan, np.nan], [0, np.inf, -np.inf, np.nan, np.\n    nan], [0, np.inf, -np.inf, np.nan, np.nan], [0, np.inf, -np.inf, np.nan,\n    np.nan], [0, np.inf, -np.inf, np.nan, np.nan], [0, np.inf, -np.inf, np.\n    nan, np.nan], [3431, 1001.0, 1074.2, 1016.739872, 6.253782], [2917, \n    1002.0, 1028.1, 1013.883922, 4.859204], [0, np.inf, -np.inf, np.nan, np\n    .nan], [0, np.inf, -np.inf, np.nan, np.nan], [0, np.inf, -np.inf, np.\n    nan, np.nan], [0, np.inf, -np.inf, np.nan, np.nan]]}), ((datetime(1996,\n    7, 15), datetime(1996, 9, 15)), {'aggregateby': '1m', 'groupby': [\n    'city']}, {'index': pd.MultiIndex.from_product([[datetime(1996, 7, 1),\n    datetime(1996, 8, 1), datetime(1996, 9, 1)], ['istanbul', 'london',\n    'paris']], names=['datetime', 'city']), 'data': [[1244, 1001, 1074.2, \n    1014.047186, 4.20745], [780, 1001, 1037.3, 1017.958462, 7.899298], [\n    1407, 1006.1, 1028.1, 1018.44506, 5.914784], [1063, 1003, 1019, \n    1012.393979, 2.477956], [639, 1002, 1028.1, 1014.007668, 6.711384], [\n    1215, 1004.1, 1026.1, 1015.122387, 4.913515], [0, np.inf, -np.inf, np.\n    nan, np.nan], [0, np.inf, -np.inf, np.nan, np.nan], [0, np.inf, -np.inf,\n    np.nan, np.nan]]}), ((datetime(1996, 7, 15), datetime(1996, 7, 20)), {\n    'aggregateby': '1d', 'groupby': ['city']}, {'index': pd.MultiIndex.\n    from_product([[datetime(1996, 7, 15), datetime(1996, 7, 16), datetime(\n    1996, 7, 17), datetime(1996, 7, 18), datetime(1996, 7, 19), datetime(\n    1996, 7, 20)], ['istanbul', 'london', 'paris']], names=['datetime',\n    'city']), 'data': [[43, 1013.2, 1017.9, 1015.55814, 1.25998], [23, \n    1027.1, 1032.2, 1029.286957, 1.153936], [48, 1024.0, 1027.1, \n    1025.845833, 0.640949], [37, 1009.1, 1074.2, 1013.621622, 10.25178], [\n    25, 1030.1, 1033.2, 1032.356, 0.975738], [47, 1025.1, 1028.1, \n    1026.695745, 1.044939], [43, 1010.2, 1016.3, 1012.974419, 1.654043], [\n    27, 1027.1, 1037.3, 1029.459259, 2.167138], [45, 1022.0, 1026.1, \n    1024.371111, 1.340584], [43, 1015.2, 1016.3, 1015.993023, 0.493396], [\n    29, 1025.1, 1028.1, 1026.893103, 0.713385], [48, 1023.0, 1024.0, \n    1023.729167, 0.44439], [42, 1016.3, 1017.3, 1016.77619, 0.499433], [24,\n    1025.1, 1028.1, 1026.35, 0.968246], [44, 1022.0, 1025.1, 1023.938636, \n    0.911596], [41, 1017.3, 1019, 1018.141463, 0.693515], [25, 1023.0, \n    1025.1, 1024.372, 0.831153], [45, 1022.0, 1024.0, 1023.022222, 0.614234\n    ]]}), ((datetime(1996, 7, 16, 11), datetime(1996, 7, 16, 15)), {\n    'aggregateby': '1h'}, {'index': pd.Index([datetime(1996, 7, 16, 11),\n    datetime(1996, 7, 16, 12), datetime(1996, 7, 16, 13), datetime(1996, 7,\n    16, 14), datetime(1996, 7, 16, 15)], name='datetime'), 'data': [[5, \n    1012.2, 1033.2, 1022.76, 8.82102], [5, 1012.2, 1033.2, 1022.76, 8.82102\n    ], [4, 1012.2, 1033.2, 1026.425, 8.582067], [5, 1011.2, 1033.2, 1021.96,\n    9.063465], [5, 1011.2, 1032.2, 1021.56, 8.708295]]}), ((datetime(1996, \n    7, 16, 11), datetime(1996, 7, 16, 15)), {'aggregateby': '1h', 'tags': {\n    'city': 'paris'}}, {'index': pd.Index([datetime(1996, 7, 16, 11),\n    datetime(1996, 7, 16, 12), datetime(1996, 7, 16, 13), datetime(1996, 7,\n    16, 14), datetime(1996, 7, 16, 15)], name='datetime'), 'data': [[2, \n    1028.1, 1028.1, 1028.1, 0.0], [2, 1028.1, 1028.1, 1028.1, 0.0], [1, \n    1027.1, 1027.1, 1027.1, 0.0], [2, 1027.1, 1027.1, 1027.1, 0.0], [2, \n    1026.1, 1027.1, 1026.6, 0.5]]}), ((datetime(1996, 7, 16, 11), datetime(\n    1996, 7, 16, 15)), {'aggregateby': '1h', 'tags': {'city': {'$ne':\n    'paris'}}}, {'index': pd.Index([datetime(1996, 7, 16, 11), datetime(\n    1996, 7, 16, 12), datetime(1996, 7, 16, 13), datetime(1996, 7, 16, 14),\n    datetime(1996, 7, 16, 15)], name='datetime'), 'data': [[3, 1012.2, \n    1033.2, 1019.2, 9.899495], [3, 1012.2, 1033.2, 1019.2, 9.899495], [3, \n    1012.2, 1033.2, 1026.2, 9.899495], [3, 1011.2, 1033.2, 1018.533333, \n    10.370899], [3, 1011.2, 1032.2, 1018.2, 9.899495]]}), ((datetime(1996, \n    7, 16, 11), datetime(1996, 7, 16, 13)), {'aggregateby': '1h', 'groupby':\n    ['city'], 'tags': {'city': {'$in': ['paris', 'london']}}}, {'index': pd\n    .MultiIndex.from_product([[datetime(1996, 7, 16, 11), datetime(1996, 7,\n    16, 12), datetime(1996, 7, 16, 13)], ['london', 'paris']], names=[\n    'datetime', 'city']), 'data': [[1, 1033.2, 1033.2, 1033.2, 0.0], [2, \n    1028.1, 1028.1, 1028.1, 0.0], [1, 1033.2, 1033.2, 1033.2, 0.0], [2, \n    1028.1, 1028.1, 1028.1, 0.0], [2, 1033.2, 1033.2, 1033.2, 0.0], [1, \n    1027.1, 1027.1, 1027.1, 0.0]]}), ((datetime(1996, 7, 16, 11), datetime(\n    1996, 7, 16, 13)), {'aggregateby': '2h', 'tags': {'city': {'$in': [\n    'paris', 'london']}}}, {'index': pd.Index([datetime(1996, 7, 16, 10),\n    datetime(1996, 7, 16, 12)], name='datetime'), 'data': [[3, 1028.1, \n    1033.2, 1029.8, 2.40416305609], [6, 1027.1, 1033.2, 1030.48333333, \n    2.73704016938]]}), ((datetime(1996, 7, 16, 11), datetime(1996, 7, 16, \n    13)), {'aggregateby': '2h', 'groupby': ['city'], 'tags': {'city': {\n    '$in': ['paris', 'london']}}}, {'index': pd.MultiIndex.from_product([[\n    datetime(1996, 7, 16, 10), datetime(1996, 7, 16, 12)], ['london',\n    'paris']], names=['datetime', 'city']), 'data': [[1, 1033.2, 1033.2, \n    1033.2, 0.0], [2, 1028.1, 1028.1, 1028.1, 0.0], [3, 1033.2, 1033.2, \n    1033.2, 0.0], [3, 1027.1, 1028.1, 1027.766666, 0.471404]]}), ((datetime\n    (1995, 7, 10), datetime(1995, 8, 10)), {'aggregateby': '1d'}, {'index':\n    pd.Index([], name='datetime'), 'data': []}), ((datetime(1996, 7, 10),\n    datetime(1996, 7, 9)), {'aggregateby': '1d'}, {'index': pd.Index([],\n    name='datetime'), 'data': []})])"
}