{
    "functionName": "test_replace_in_fort3_sort_new_replace_args_bonds",
    "className": null,
    "fileName": "/mortele_&_OccamTools/test_&_test_replace_in_fort3.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "tol = 1e-14\natom_names, _, bonds, _, _, _, _, _, _ = _parse_fort_3_file(file_name)\nrepl = Fort3Replacement('bond type', replace=True, content=['H', 'O', 4, 2]\n    ), Fort3Replacement('bond type', replace=True, content=['H+', 'H', 7, 6]\n    ), Fort3Replacement('bond type', new=True, content=['H', 'H', 9.1, 3.6]\n    ), Fort3Replacement('bond type', new=True, content=['H+', 'O', 9.4, 3.3])\nbonds_new = _sort_new_replace_args_bonds(atom_names, bonds, *repl)\nassert len(bonds_new) == 5\nnames = [('H', 'O'), ('H+', 'H'), ('H', 'H'), ('H+', 'O')]\nlengths = [4.0, 7.0, 9.1, 9.4]\nepsilons = [2.0, 6.0, 3.6, 3.3]\nfor name, length, eps in zip(names, lengths, epsilons):\n    found = False\n    n1, n2 = name\n    for bond in bonds_new:\n        name_1, name_2 = bond._content[:2]\n        if name_1 == n1 and name_2 == n2 or name_1 == n2 and name_2 == n1:\n            found = True\n            assert bond._content[2] == pytest.approx(length, abs=tol)\n            assert bond._content[3] == pytest.approx(eps, abs=tol)\n    assert found\nfor n1, n2 in zip(['not', 'H'], ['H', 'not']):\n    caught = False\n    repl = Fort3Replacement('bond type', new=True, content=[n1, n2, 0, 0]),\n    try:\n        _sort_new_replace_args_bonds(atom_names, bonds, *repl)\n    except ValueError:\n        caught = True\n    assert caught is True\nrepl = Fort3Replacement('bond type', new=True, content=['O', 0, 0]\n    ), Fort3Replacement('bond type', new=True, content=['O', 'O', 0, 0]\n    ), Fort3Replacement('bond type', replace=True, content=['.', 'H', 0, 0]\n    ), Fort3Replacement('bond type', new=True, content=['H', 'O', 0, 0]\n    ), Fort3Replacement('bond type', replace=True, content=['H', 'H', 0, 0])\nfor r in repl:\n    caught = False\n    try:\n        _sort_new_replace_args_bonds(atom_names, bonds, r)\n    except ValueError:\n        caught = True\n    assert caught is True\n"
}