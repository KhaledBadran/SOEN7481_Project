{
    "functionName": "test_policy_live_loading",
    "className": "TestSLUGSAuthenticationAndAccessControl",
    "fileName": "/OpenKMIP_&_PyKMIP/kmip_&_tests_&_functional_&_services_&_test_authentication.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "\"\"\"\n        Test that:\n        1. a user in Group A can create and retrieve a symmetric key\n        2. a user in Group B can also retrieve the same symmetric key\n        3. a user in Group B cannot destroy the same symmetric key\n        4. a policy is uploaded if created after server start up\n        5. a user in Group A cannot retrieve the same symmetric key, and\n        6. a user in Group B can destroy the same symmetric key.\n        \"\"\"\nwith self.client_john_doe as c:\n    uid = c.create(enums.CryptographicAlgorithm.AES, 256,\n        operation_policy_name='policy_1')\n    self.assertIsInstance(uid, six.string_types)\n    key = c.get(uid)\n    self.assertIsInstance(key, objects.SymmetricKey)\n    self.assertEqual(key.cryptographic_algorithm, enums.\n        CryptographicAlgorithm.AES)\n    self.assertEqual(key.cryptographic_length, 256)\nwith self.client_john_smith as c:\n    key = c.get(uid)\n    self.assertIsInstance(key, objects.SymmetricKey)\n    self.assertEqual(key.cryptographic_algorithm, enums.\n        CryptographicAlgorithm.AES)\n    self.assertEqual(key.cryptographic_length, 256)\n    self.assertRaises(exceptions.KmipOperationFailure, c.destroy, uid)\nwith open('/tmp/pykmip/policies/policy_overwrite.json', 'w') as f:\n    f.write('{\\n')\n    f.write('  \"policy_1\": {\\n')\n    f.write('    \"groups\": {\\n')\n    f.write('      \"Group A\": {\\n')\n    f.write('        \"SYMMETRIC_KEY\": {\\n')\n    f.write('          \"GET\": \"DISALLOW_ALL\",\\n')\n    f.write('          \"DESTROY\": \"DISALLOW_ALL\"\\n')\n    f.write('        }\\n')\n    f.write('      },\\n')\n    f.write('      \"Group B\": {\\n')\n    f.write('        \"SYMMETRIC_KEY\": {\\n')\n    f.write('          \"GET\": \"ALLOW_ALL\",\\n')\n    f.write('          \"DESTROY\": \"ALLOW_ALL\"\\n')\n    f.write('        }\\n')\n    f.write('      }\\n')\n    f.write('    }\\n')\n    f.write('  }\\n')\n    f.write('}\\n')\ntime.sleep(1)\nwith self.client_john_doe as c:\n    self.assertRaises(exceptions.KmipOperationFailure, c.get, uid)\n    self.assertRaises(exceptions.KmipOperationFailure, c.destroy, uid)\nwith self.client_john_smith as c:\n    key = c.get(uid)\n    self.assertIsInstance(key, objects.SymmetricKey)\n    self.assertEqual(key.cryptographic_algorithm, enums.\n        CryptographicAlgorithm.AES)\n    self.assertEqual(key.cryptographic_length, 256)\n    c.destroy(uid)\n    self.assertRaises(exceptions.KmipOperationFailure, c.get, uid)\n    self.assertRaises(exceptions.KmipOperationFailure, c.destroy, uid)\nos.remove('/tmp/pykmip/policies/policy_overwrite.json')\ntime.sleep(1)\n"
}