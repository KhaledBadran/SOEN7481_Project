{
    "functionName": "test_low_res_correction",
    "className": null,
    "fileName": "/MetaSys-LISBP_&_IsoCor/isocor_&_tests_&_test_correction_process_LowRes.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "\"\"\"Correction of non-tracer elements depending on resolution and formula.\n\n    Measured values should be corrected for the incorporation of natural isotopes of\n    non-tracers elements if the resolution was not high enough to distinguish them.\n    The resolution depends on m/z ratio and thus the formula of the metabolite.\n    The higher the mass, the higher the resolution should be used to distinguish all\n    isotopomers and avoid to need correction.\n    \"\"\"\nformula = data['formula']\np1H = data_iso['H']['abundance'][0]\np2H = data_iso['H']['abundance'][1]\np12C = data_iso['C']['abundance'][0]\np13C = data_iso['C']['abundance'][1]\npur12C = data['tracer_purity'][0]\npur13C = data['tracer_purity'][1]\nv_measured = eval(data['v_measured'])\nv_expected = eval(data['v_expected'])\nmetabolite = hrcor.LowResMetaboliteCorrector(formula, data['tracer'],\n    data_isotopes=data_iso, correct_NA_tracer=data['correct_NA_tracer'],\n    derivative_formula=None, tracer_purity=data['tracer_purity'])\n_, v_corrected, _, _ = metabolite.correct(v_measured)\nnp.testing.assert_allclose(v_corrected, v_expected, rtol=1e-07)\npytest.mark.parametrize('data', [{'formula': 'C2H2', 'tracer': '13C',\n    'v_expected': '[1., 0., 0.]', 'v_measured':\n    '[p1H * p1H, p1H * p2H * 2, p2H * p2H]', 'correct_NA_tracer': False,\n    'tracer_purity': [0.0, 1.0]}, {'formula': 'C2H2P10', 'tracer': '13C',\n    'v_expected': '[0.7, 0.2, 0.1]', 'v_measured':\n    '[0.7*p1H * p1H, 0.7*p1H * p2H * 2+0.2*p1H * p1H, 0.7*p2H * p2H+0.2*p1H * p2H * 2+0.1*p1H * p1H]'\n    , 'correct_NA_tracer': False, 'tracer_purity': [0.0, 1.0]}, {'formula':\n    'OH2', 'tracer': '18O', 'v_expected': '[0.6, 0.4]', 'v_measured':\n    '[0.6*p1H**2, 0.6*p2H**2+0.4*p1H**2]', 'correct_NA_tracer': False,\n    'tracer_purity': [0.0, 0.0, 1.0]}, {'formula': 'OH2', 'tracer': '17O',\n    'v_expected': '[0.6, 0.4]', 'v_measured':\n    '[0.6*p1H**2, 0.6*p1H*p2H*2+0.4*p1H**2]', 'correct_NA_tracer': False,\n    'tracer_purity': [0.0, 1.0, 0.0]}, {'formula': 'C2H2P10', 'tracer':\n    '13C', 'v_expected': '[0.7, 0.2, 0.1]', 'v_measured':\n    '[0.7*p1H*p1H*p12C**2, 0.7*p1H*p2H*2*p12C**2 + 0.7*p1H*p1H*p12C*p13C*2 + 0.2*p1H*p1H*p12C, 0.7*p2H*p2H*p12C**2 + 0.7*p1H*p2H*2*p12C*p13C*2 + 0.7*p1H*p1H*p13C**2 +0.2*p1H*p1H*p13C + 0.2*p1H*p2H*2*p12C + 0.1*p1H*p1H]'\n    , 'correct_NA_tracer': True, 'tracer_purity': [0.0, 1.0]}, {'formula':\n    'C2H2P10', 'tracer': '13C', 'v_expected': '[0.7, 0.2, 0.1]',\n    'v_measured':\n    '[0.7*p1H**2 + 0.2*p1H**2*pur12C + 0.1*p1H**2*pur12C**2, 0.7*p1H*p2H*2 + 0.2*p1H**2*pur13C + 0.2*p1H*p2H*2*pur12C + 0.1*p1H**2*pur12C*pur13C*2 + 0.1*p1H*p2H*2*pur12C**2, 0.7*p2H**2 + 0.2*p1H*p2H*2*pur13C + 0.2*p2H**2*pur12C + 0.1*p1H**2*pur13C**2 + 0.1*p1H*p2H*2*pur12C*pur13C*2 + 0.1*p2H**2*pur12C**2]'\n    , 'correct_NA_tracer': False, 'tracer_purity': [0.3, 0.7]}])"
}