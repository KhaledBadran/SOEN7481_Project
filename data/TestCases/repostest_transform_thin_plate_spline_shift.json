{
    "functionName": "test_transform_thin_plate_spline_shift",
    "className": "TestTPSTransformLayer",
    "fileName": "/Lasagne_&_Lasagne/lasagne_&_tests_&_layers_&_test_special.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "from lasagne.layers import InputLayer, TPSTransformerLayer\nfrom theano.tensor import constant\nbatchsize = 5\nnum_control_points = 16\ndest_offset = np.ones(shape=(batchsize, 2 * num_control_points))\nl_in = InputLayer((batchsize, 3, 28, 28))\nl_loc = InputLayer((batchsize, 2 * num_control_points))\nlayer = TPSTransformerLayer(l_in, l_loc, control_points=num_control_points)\nimage = np.zeros(shape=(28, 28))\nimage[([0, -1]), :] = 1\nimage[:, ([0, -1])] = 1\ninputs = np.tile(image, (batchsize, 3, 1, 1))\nshifted_input = np.ones(shape=(28, 28))\nshifted_input[:13, :13] = 0\nshifted_input[(13), :13] = 0.50000271\nshifted_input[:13, (13)] = 0.50000271\nshifted_input[13, 13] = 0.75000271\nshifted_input = np.tile(shifted_input, (batchsize, 3, 1, 1))\noutputs = layer.get_output_for([constant(inputs), constant(dest_offset)]).eval(\n    )\nnp.testing.assert_allclose(shifted_input, outputs, atol=1e-05)\n"
}