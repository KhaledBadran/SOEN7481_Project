{
    "functionName": "test_pk2d_cls",
    "className": null,
    "fileName": "/LSSTDESC_&_CCL/pyccl_&_tests_&_test_pk2d.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "\"\"\"\n    Test interplay between Pk2D and the Limber integrator\n    \"\"\"\ncosmo = ccl.Cosmology(Omega_c=0.27, Omega_b=0.045, h=0.67, A_s=1e-10, n_s=0.96)\nz = np.linspace(0.0, 1.0, 200)\nn = np.exp(-((z - 0.5) / 0.1) ** 2)\nlens1 = ccl.WeakLensingTracer(cosmo, (z, n))\nells = np.arange(2, 10)\ncells = ccl.angular_cl(cosmo, lens1, lens1, ells)\nassert all_finite(cells)\nassert_raises(ValueError, ccl.angular_cl, cosmo, lens1, lens1, ells, p_of_k_a=1\n    )\npsp = ccl.Pk2D(pkfunc=lpk2d, cosmo=cosmo)\ncells = ccl.angular_cl(cosmo, lens1, lens1, ells, p_of_k_a=psp)\nassert all_finite(cells)\n"
}