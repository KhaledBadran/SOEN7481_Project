{
    "functionName": "test_train_multivariate",
    "className": "UnSupervisedIOHMMTests",
    "fileName": "/Mogeng_&_IOHMM/tests_&_test_UnSupervisedIOHMM.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "self.model = UnSupervisedIOHMM(num_states=2, max_EM_iter=100, EM_tol=1e-06)\nself.model.set_models(model_initial=CrossEntropyMNL(solver='newton-cg',\n    reg_method='l2'), model_transition=CrossEntropyMNL(solver='newton-cg',\n    reg_method='l2'), model_emissions=[OLS(), DiscreteMNL(reg_method='l2')])\nself.model.set_inputs(covariates_initial=[], covariates_transition=[],\n    covariates_emissions=[[], ['Pacc']])\nself.model.set_outputs([['rt'], ['corr']])\nself.model.set_data([self.data_speed])\nself.model.train()\nnp.testing.assert_array_almost_equal(self.model.model_emissions[0][0].coef,\n    np.array([[5.5]]), decimal=1)\nnp.testing.assert_array_almost_equal(self.model.model_emissions[1][0].coef,\n    np.array([[6.4]]), decimal=1)\nnp.testing.assert_array_almost_equal(self.model.model_emissions[0][0].\n    dispersion, np.array([[0.036]]), decimal=2)\nnp.testing.assert_array_almost_equal(self.model.model_emissions[1][0].\n    dispersion, np.array([[0.063]]), decimal=2)\nnp.testing.assert_array_almost_equal(np.exp(self.model.model_transition[0].\n    predict_log_proba(self.model.inp_transitions_all_sequences)).sum(axis=0\n    ), np.array([387, 51]), decimal=0)\nnp.testing.assert_array_almost_equal(np.exp(self.model.model_transition[1].\n    predict_log_proba(self.model.inp_transitions_all_sequences)).sum(axis=0\n    ), np.array([37, 401.0]), decimal=0)\njson_dict = self.model.to_json('tests/IOHMM_models/UnSupervisedIOHMM/')\nself.assertEqual(json_dict['data_type'], 'UnSupervisedIOHMM')\nself.assertSetEqual(set(json_dict['properties'].keys()), set(['num_states',\n    'EM_tol', 'max_EM_iter', 'covariates_initial', 'covariates_transition',\n    'covariates_emissions', 'responses_emissions', 'model_initial',\n    'model_transition', 'model_emissions']))\nwith open('tests/IOHMM_models/UnSupervisedIOHMM/model.json', 'w') as outfile:\n    json.dump(json_dict, outfile, indent=4, sort_keys=True)\n"
}