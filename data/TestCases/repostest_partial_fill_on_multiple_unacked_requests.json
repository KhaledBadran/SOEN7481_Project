{
    "functionName": "test_partial_fill_on_multiple_unacked_requests",
    "className": null,
    "fileName": "/nabicht_&_Buttonwood/tests_&_test_MarketObjects_&_test_Events_&_test_ordereventchain.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "n = NewOrderCommand(1, 1234235.123, 2342, 'user_x', MARKET, BID_SIDE, FAR,\n    Price('34.52'), 1000)\noec = OrderEventChain(n, LOGGER, MonotonicIntID())\nassert len(oec.open_exposure_requests()) == 1\nassert oec.most_recent_requested_exposure() == Exposure(Price('34.52'), 1000, 1\n    )\ncr1 = CancelReplaceCommand(2, 1234235.863, 2342, 'user_x', MARKET, BID_SIDE,\n    Price('34.51'), 800)\noec.apply_cancel_replace_command(cr1)\nassert len(oec.open_exposure_requests()) == 2\nassert oec.open_exposure_requests()[0] == Exposure(Price('34.52'), 1000, 1)\nassert oec.open_exposure_requests()[1] == Exposure(Price('34.51'), 800, 2)\ncr2 = CancelReplaceCommand(3, 1234236.842, 2342, 'user_x', MARKET, BID_SIDE,\n    Price('34.55'), 800)\noec.apply_cancel_replace_command(cr2)\nassert len(oec.open_exposure_requests()) == 3\nassert oec.open_exposure_requests()[0] == Exposure(Price('34.52'), 1000, 1)\nassert oec.open_exposure_requests()[1] == Exposure(Price('34.51'), 800, 2)\nassert oec.open_exposure_requests()[2] == Exposure(Price('34.55'), 800, 3)\ncr3 = CancelReplaceCommand(4, 1234236.842, 2342, 'user_x', MARKET, BID_SIDE,\n    Price('34.56'), 800)\noec.apply_cancel_replace_command(cr3)\nassert len(oec.open_exposure_requests()) == 4\nassert oec.open_exposure_requests()[0] == Exposure(Price('34.52'), 1000, 1)\nassert oec.open_exposure_requests()[1] == Exposure(Price('34.51'), 800, 2)\nassert oec.open_exposure_requests()[2] == Exposure(Price('34.55'), 800, 3)\nassert oec.open_exposure_requests()[3] == Exposure(Price('34.56'), 800, 4)\npf1 = PartialFillReport(5, 1234237.123, 2342, 'user_x', MARKET, cr2, 10,\n    Price('34.55'), BID_SIDE, 999, 790)\noec.apply_partial_fill_report(pf1)\nassert len(oec.open_exposure_requests()) == 4\nassert oec.open_exposure_requests()[0] == Exposure(Price('34.52'), 1000, 1)\nassert oec.open_exposure_requests()[1] == Exposure(Price('34.51'), 800, 2)\nassert oec.open_exposure_requests()[2] == Exposure(Price('34.55'), 790, 3)\nassert oec.open_exposure_requests()[3] == Exposure(Price('34.56'), 800, 4)\npf2 = PartialFillReport(6, 1234237.123, 2342, 'user_x', MARKET, cr2, 10,\n    Price('34.55'), BID_SIDE, 1000, 780)\noec.apply_partial_fill_report(pf2)\nassert len(oec.open_exposure_requests()) == 4\nassert oec.open_exposure_requests()[0] == Exposure(Price('34.52'), 1000, 1)\nassert oec.open_exposure_requests()[1] == Exposure(Price('34.51'), 800, 2)\nassert oec.open_exposure_requests()[2] == Exposure(Price('34.55'), 780, 3)\nassert oec.open_exposure_requests()[3] == Exposure(Price('34.56'), 800, 4)\npf3 = PartialFillReport(6, 1234237.123, 2342, 'user_x', MARKET, cr3, 50,\n    Price('34.56'), BID_SIDE, 1001, 750)\noec.apply_partial_fill_report(pf3)\nassert len(oec.open_exposure_requests()) == 4\nassert oec.open_exposure_requests()[0] == Exposure(Price('34.52'), 1000, 1)\nassert oec.open_exposure_requests()[1] == Exposure(Price('34.51'), 800, 2)\nassert oec.open_exposure_requests()[2] == Exposure(Price('34.55'), 780, 3)\nassert oec.open_exposure_requests()[3] == Exposure(Price('34.56'), 750, 4)\nack1 = AcknowledgementReport(10, 1234235.123, 2342, 'user_x', MARKET, n,\n    Price('34.52'), 1000, None)\noec.apply_acknowledgement_report(ack1)\nassert len(oec.open_exposure_requests()) == 3\nassert oec.open_exposure_requests()[0] == Exposure(Price('34.51'), 800, 2)\nassert oec.open_exposure_requests()[1] == Exposure(Price('34.55'), 780, 3)\nassert oec.open_exposure_requests()[2] == Exposure(Price('34.56'), 750, 4)\nassert oec.current_exposure() == Exposure(Price('34.52'), 1000, 10)\nack2 = AcknowledgementReport(11, 1234235.123, 2342, 'user_x', MARKET, cr1,\n    Price('34.51'), 800, None)\noec.apply_acknowledgement_report(ack2)\nassert len(oec.open_exposure_requests()) == 2\nassert oec.open_exposure_requests()[0] == Exposure(Price('34.55'), 780, 3)\nassert oec.open_exposure_requests()[1] == Exposure(Price('34.56'), 750, 4)\nassert oec.current_exposure() == Exposure(Price('34.51'), 800, 11)\nack3 = AcknowledgementReport(12, 1234235.123, 2342, 'user_x', MARKET, cr2,\n    Price('34.55'), 780, None)\noec.apply_acknowledgement_report(ack3)\nassert len(oec.open_exposure_requests()) == 1\nprint(oec.open_exposure_requests()[0])\nassert oec.open_exposure_requests()[0] == Exposure(Price('34.56'), 750, 4)\nassert oec.current_exposure() == Exposure(Price('34.55'), 780, 12)\nack4 = AcknowledgementReport(13, 1234235.123, 2342, 'user_x', MARKET, cr3,\n    Price('34.56'), 750, None)\noec.apply_acknowledgement_report(ack4)\nassert len(oec.open_exposure_requests()) == 0\nassert oec.current_exposure() == Exposure(Price('34.56'), 750, 13)\n"
}