{
    "functionName": "run_order",
    "className": null,
    "fileName": "/PyAbel_&_PyAbel/abel_&_tests_&_test_tools_distributions.py",
    "projectName": "repos",
    "Label": false,
    "isTest": false,
    "Body": "\"\"\"\n    Test cossin distributions for even orders using Gaussian peaks.\n\n    tol = list of tolerances for order=0, order=2, order=4, ...\n    \"\"\"\nsigma = 5.0\nstep = 6 * sigma\nfor n in range(len(tol)):\n    size = int((n + 2) * step)\n    x2 = np.arange(float(size)) ** 2\n    y2 = x2[:, (None)]\n    r2 = x2 + y2\n    c2 = np.divide(y2, r2, out=np.zeros_like(r2), where=r2 != 0)\n    s2 = 1 - c2\n    r = np.sqrt(r2)\n\n    def peak(i):\n        return c2 ** i * s2 ** (n - i) * np.exp(-(r - (i + 1) * step) ** 2 /\n            (2 * sigma ** 2))\n    Q = peak(0)\n    for i in range(1, n + 1):\n        Q += peak(i)\n    for rmax in ['MIN', 'all']:\n        param = '-> rmax = {}, order={}, method = {}'.format(rmax, 2 * n,\n            method)\n        res = Distributions('ul', rmax, 2 * n, method=method).image(Q)\n        cossin = res.cossin()\n        cs = np.array([cossin[:, (int((i + 1) * step))] for i in range(n + 1)])\n        assert_allclose(cs, np.identity(n + 1), atol=tol[n], err_msg=param)\n        res.Ibeta()\n"
}