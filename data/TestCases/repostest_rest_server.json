{
    "functionName": "test_rest_server",
    "className": "TestXenaOffline",
    "fileName": "/xenadevel_&_PyXenaValkyrie/tests_&_test_offline.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "if self.api == ApiType.rest:\n    pytest.skip('Skip test - REST API')\nif is_local_host(self.server_ip):\n    pytest.skip('Skip test - localhost')\nchassis = self.xm.session.chassis_list[self.chassis]\nchassis.reserve()\nchassis.set_attributes(c_restport=self.server_port)\nassert int(chassis.get_attribute('c_restport')) == self.server_port\nassert chassis.get_attribute('c_reststatus').lower() == 'service_on'\nassert chassis.get_attribute('c_restenable').lower() == 'on'\nbase_url = 'http://{}:{}'.format(self.server_ip, self.server_port)\nrequests.get(base_url)\nchassis.set_attributes(c_restport=self.server_port + 10)\nchassis.set_attributes(c_restcontrol='restart')\nassert chassis.get_attribute('c_reststatus').lower() == 'service_on'\nassert int(chassis.get_attribute('c_restport')) == self.server_port + 10\nbase_url = 'http://{}:{}'.format(self.server_ip, self.server_port + 10)\nrequests.get(base_url)\nchassis.set_attributes(c_restport=self.server_port)\nchassis.set_attributes(c_restcontrol='stop')\nassert chassis.get_attribute('c_reststatus').lower() == 'service_off'\nbase_url = 'http://{}:{}'.format(self.server_ip, self.server_port)\nwith pytest.raises(Exception) as _:\n    requests.get(base_url)\nchassis.set_attributes(c_restcontrol='start')\nassert chassis.get_attribute('c_reststatus').lower() == 'service_on'\nrequests.get(base_url)\nchassis.set_attributes(c_restenable='off')\nassert chassis.get_attribute('c_restenable').lower() == 'off'\nchassis.shutdown(restart=True, wait=True)\nassert chassis.get_attribute('c_restenable').lower() == 'off'\nwith pytest.raises(Exception) as _:\n    requests.get(base_url)\nchassis.reserve()\nchassis.set_attributes(c_restenable='on')\nassert chassis.get_attribute('c_restenable').lower() == 'on'\nchassis.shutdown(restart=True, wait=True)\nassert chassis.get_attribute('c_restenable').lower() == 'on'\nrequests.get(base_url)\n"
}