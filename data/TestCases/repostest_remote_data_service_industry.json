{
    "functionName": "test_remote_data_service_industry",
    "className": null,
    "fileName": "/quantOS-org_&_JAQS/test_&_test_dataservice.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "from jaqs.data.align import align\nimport pandas as pd\narr = ds.query_index_member(index='000300.SH', start_date=20130101,\n    end_date=20170505)\ndf = ds.query_industry_raw(symbol=','.join(arr), type_='SW')\ndf = ds.query_industry_raw(symbol=','.join(arr), type_='ZZ')\ntry:\n    ds.query_industry_raw(symbol=','.join(arr), type_='ZZ', level=5)\nexcept ValueError:\n    pass\ntry:\n    ds.query_industry_raw(symbol=','.join(arr), type_='blabla')\nexcept ValueError:\n    pass\nfrom jaqs.data import DataView\ndic_sec = jutil.group_df_to_dict(df, by='symbol')\ndic_sec = {sec: df.reset_index() for sec, df in dic_sec.items()}\ndf_ann = pd.concat([df.loc[:, ('in_date')].rename(sec) for sec, df in\n    dic_sec.items()], axis=1)\ndf_value = pd.concat([df.loc[:, ('industry1_code')].rename(sec) for sec, df in\n    dic_sec.items()], axis=1)\ndates_arr = ds.query_trade_dates(20140101, 20170505)\nres = align(df_value, df_ann, dates_arr)\ndef align_single_df(df_one_sec):\n    df_value = df_one_sec.loc[:, (['industry1_code'])]\n    df_ann = df_one_sec.loc[:, (['in_date'])]\n    res = align(df_value, df_ann, dates_arr)\n    return res\nres_list = [align_single_df(df) for df in list(dic_sec.values())[:10]]\nres = pd.concat(res_list, axis=1)\n"
}