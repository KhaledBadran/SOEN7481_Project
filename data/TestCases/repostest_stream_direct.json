{
    "functionName": "test_stream_direct",
    "className": null,
    "fileName": "/halcy_&_Mastodon.py/tests_&_test_streaming.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "patch_streaming()\nconversations = []\nlistener = CallbackStreamListener(conversation_handler=lambda x:\n    conversations.append(x))\ndef do_activities():\n    time.sleep(5)\n    api2.status_post('@mastodonpy_test todo funny text here', visibility=\n        'direct')\n    time.sleep(10)\n    streaming_close()\nt = threading.Thread(args=(), target=do_activities)\nt.start()\nstream = None\ntry:\n    stream = api.stream_direct(listener, run_async=True)\n    time.sleep(20)\nfinally:\n    if stream != None:\n        stream.close()\nassert len(conversations) == 1\npytest.mark.vcr(match_on=['path'])"
}