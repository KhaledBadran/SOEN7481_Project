{
    "functionName": "test_transform_image",
    "className": "TestDLImageTransformer",
    "fileName": "/intel-analytics_&_Bigdl/pyspark_&_test_&_bigdl_&_dlframes_&_test_dl_image_transformer.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "if not self.sc.version.startswith('1.5'):\n    image_frame = DLImageReader.readImages(self.image_path, self.sc)\n    transformer = DLImageTransformer(Pipeline([Resize(256, 256), CenterCrop\n        (224, 224), ChannelNormalize(0.485, 0.456, 0.406, 0.229, 0.224, \n        0.225), MatToTensor()])).setInputCol('image').setOutputCol('output')\n    result = transformer.transform(image_frame)\n    assert result.count() == 1\n    first_row = result.select('output').take(1)[0][0]\n    assert first_row[0].endswith('pascal/000025.jpg')\n    assert first_row[1] == 224\n    assert first_row[2] == 224\n    assert first_row[3] == 3\n    assert first_row[4] == 21\n    assert len(first_row[5]) == 224 * 224 * 3\n"
}