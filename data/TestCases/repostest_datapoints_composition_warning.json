{
    "functionName": "test_datapoints_composition_warning",
    "className": "TestGetDatapoints",
    "fileName": "/pr-omethe-us_&_PyKED/pyked_&_tests_&_test_converters.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "\"\"\"Test valid parsing of datapoints with composition with warnings.\n        \"\"\"\nroot = etree.Element('experiment')\ndatagroup = etree.SubElement(root, 'dataGroup')\nprop = etree.SubElement(datagroup, 'property')\nprop.set('id', 'x1')\nprop.set('name', 'temperature')\nprop.set('units', 'K')\nprop = etree.SubElement(datagroup, 'property')\nprop.set('id', 'x2')\nprop.set('name', 'ignition delay')\nprop.set('units', 'us')\nprop = etree.SubElement(datagroup, 'property')\nprop.set('id', 'x3')\nprop.set('name', 'composition')\nprop.set('units', kind)\nspecieslink = etree.SubElement(prop, 'speciesLink')\nspecieslink.set('preferredKey', 'H2')\ndatapoint = etree.SubElement(datagroup, 'dataPoint')\nx1 = etree.SubElement(datapoint, 'x1')\nx1.text = str(1000.0)\nx2 = etree.SubElement(datapoint, 'x2')\nx2.text = str(100.0)\nx3 = etree.SubElement(datapoint, 'x3')\nx3.text = str(value)\nwith pytest.warns(UserWarning) as record:\n    datapoints = get_datapoints(root)\nm = str(record.pop(UserWarning).message)\nassert m == 'Missing InChI for species H2'\nm = str(record.pop(UserWarning).message)\nif kind == 'percent':\n    assert m == 'Assuming percent in composition means mole percent'\n    kind = 'mole percent'\nelif kind == 'ppm':\n    assert m == 'Assuming molar ppm in composition and converting to mole fraction'\n    kind = 'mole fraction'\n    value *= 1e-06\nelif kind == 'ppb':\n    assert m == 'Assuming molar ppb in composition and converting to mole fraction'\n    kind = 'mole fraction'\n    value *= 1e-09\nassert len(datapoints) == 1\ndatapoint = datapoints[0]\nassert datapoint['temperature'] == [str(1000.0) + ' K']\nassert datapoint['ignition-delay'] == [str(100.0) + ' us']\nassert datapoint['composition']['kind'] == kind\nassert datapoint['composition']['species'][0] == {'amount': [value],\n    'species-name': 'H2', 'InChI': None}\npytest.mark.parametrize('kind, value', [('percent', 100.0), ('ppm', 1.0), (\n    'ppb', 1.0)])"
}