{
    "functionName": "create_policies",
    "className": "Create_Code_Build",
    "fileName": "/pbx-gs_&_OSBot-GSuite/setup_&_test_Create_Code_Build.py",
    "projectName": "repos",
    "Label": false,
    "isTest": false,
    "Body": "cloud_watch_arn = (\n    'arn:aws:logs:eu-west-2:244560807427:log-group:/aws/codebuild/{0}:log-stream:*'\n    .format(self.project_name))\npolicies = {'Cloud-Watch-Policy': {'Version': '2012-10-17', 'Statement': [{\n    'Effect': 'Allow', 'Action': ['logs:CreateLogGroup',\n    'logs:CreateLogStream', 'logs:PutLogEvents'], 'Resource': [\n    cloud_watch_arn]}]}, 'Secret-Manager': {'Version': '2012-10-17',\n    'Statement': [{'Effect': 'Allow', 'Action': [\n    'secretsmanager:GetSecretValue', 'secretsmanager:DescribeSecret'],\n    'Resource': [\n    'arn:aws:secretsmanager:eu-west-2:244560807427:secret:slack-gs-bot-*',\n    'arn:aws:secretsmanager:eu-west-2:244560807427:secret:elastic_gsuite_data-*'\n    ]}]}, 'Download_Image': {'Version': '2012-10-17', 'Statement': [{\n    'Effect': 'Allow', 'Action': ['ecr:GetAuthorizationToken',\n    'ecr:BatchCheckLayerAvailability', 'ecr:GetDownloadUrlForLayer',\n    'ecr:GetRepositoryPolicy', 'ecr:DescribeRepositories', 'ecr:ListImages',\n    'ecr:DescribeImages', 'ecr:BatchGetImage'], 'Resource': '*'}]},\n    'Invoke_Lambda_Functions': {'Version': '2012-10-17', 'Statement': [{\n    'Effect': 'Allow', 'Action': 'lambda:InvokeFunction', 'Resource':\n    'arn:aws:lambda:*:*:function:*'}]}, 'Secret-Manager': {'Version':\n    '2012-10-17', 'Statement': [{'Effect': 'Allow', 'Action': [\n    'secretsmanager:GetSecretValue', 'secretsmanager:DescribeSecret'],\n    'Resource': [\n    'arn:aws:secretsmanager:eu-west-2:244560807427:secret:slack-gs-bot-*',\n    'arn:aws:secretsmanager:eu-west-2:244560807427:secret:elastic*',\n    'arn:aws:secretsmanager:eu-west-2:244560807427:secret:gsuite*']}]},\n    'Update_Lambda': {'Version': '2012-10-17', 'Statement': [{'Effect':\n    'Allow', 'Action': ['s3:PutObject'], 'Resource': [\n    'arn:aws:s3:::gs-lambda-tests/dinis/lambdas/osbot_gsuite_lambdas_gdocs.zip'\n    ]}, {'Effect': 'Allow', 'Action': ['lambda:CreateFunction'], 'Resource':\n    [\n    'arn:aws:lambda:eu-west-2:244560807427:function:osbot_gsuite_lambdas_gdocs'\n    ]}]}}\npolicies_arns = list(self.code_build.iam.role_policies().values())\npolicies_names = list(self.code_build.iam.role_policies().keys())\nself.code_build.iam.role_policies_detach(policies_arns)\nfor policies_name in policies_names:\n    self.code_build.iam.policy_delete(policies_name)\npolicies_arns = self.code_build.policies_create(policies)\nself.code_build.iam.role_policies_attach(policies_arns)\n"
}