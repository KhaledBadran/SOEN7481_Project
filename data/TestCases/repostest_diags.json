{
    "functionName": "test_diags",
    "className": null,
    "fileName": "/GPflow_&_GPflow/tests_&_gpflow_&_test_kullback_leiblers.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "\"\"\"\n    The covariance of q(x) can be Cholesky matrices or diagonal matrices.\n    Here we make sure the behaviours overlap.\n    \"\"\"\nchol_from_diag = tf.stack([tf.linalg.diag(Datum.sqrt_diag[:, (i)]) for i in\n    range(Datum.N)])\nkl_diag = gauss_kl(Datum.mu, Datum.sqrt_diag, Datum.K if white else None)\nkl_dense = gauss_kl(Datum.mu, chol_from_diag, Datum.K if white else None)\nnp.testing.assert_allclose(kl_diag, kl_dense)\npytest.mark.parametrize('white', [True, False])"
}