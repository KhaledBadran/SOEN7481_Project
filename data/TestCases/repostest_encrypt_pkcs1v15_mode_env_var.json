{
    "functionName": "test_encrypt_pkcs1v15_mode_env_var",
    "className": "TestEncryption",
    "fileName": "/funilrys_&_PyTravisCI/tests_&_core_&_test_encryption.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "\"\"\"\n        Test of :class:`PyTravisCI.encryption.Encryption.encrypt` with\n        the :code:`pkcs1v15_mode` mode activated.\n        \"\"\"\nactual = Encryption(self.envs, self.public_key).encrypt(pkcs1v15_mode=True)\nfor encrypted in actual:\n    self.assertIn('secure', encrypted, 'No `secure` index given.')\n    to_decrypt = b64decode(encrypted['secure'].encode('ASCII'))\n    decrypted = self.private_key.decrypt(to_decrypt, PKCS1v15()).decode()\n    self.assertIn('=', decrypted,\n        'Environment variable not correctly encrypted.')\n    env_name, value = decrypted.replace('\"', '').replace('_', ' ').split('=')\n    self.assertEqual(self.envs[env_name], value,\n        'Environment variable not correctly encrypted.')\n"
}