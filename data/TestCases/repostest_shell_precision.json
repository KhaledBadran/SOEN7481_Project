{
    "functionName": "test_shell_precision",
    "className": "Test_grispy",
    "fileName": "/mchalela_&_GriSPy/tests_&_test_brute_force.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "gsp = self.make_gsp({})\nb, ind = gsp.shell_neighbors(self.centres, distance_lower_bound=self.\n    lower_radii, distance_upper_bound=self.upper_radii, sorted=True)\nfor i, centre in enumerate(self.centres):\n    d = np.fabs(self.data - centre)\n    mask = (d <= self.upper_radii) * (d >= self.lower_radii)\n    d = d[mask]\n    assert_equal(len(b[i]), len(d))\n    assert_almost_equal(b[i], sorted(d), decimal=14)\ngsp = self.make_gsp({(0): (-self.lbox * 0.5, self.lbox * 0.5)})\nb, ind = gsp.shell_neighbors(self.centres, distance_lower_bound=self.\n    lower_radii, distance_upper_bound=self.upper_radii, sorted=True)\nfor i, centre in enumerate(self.centres):\n    d = self.data - centre\n    mask = d > 0.5 * self.lbox\n    d[mask] = d[mask] - self.lbox\n    mask = d < -0.5 * self.lbox\n    d[mask] = d[mask] + self.lbox\n    d = np.fabs(d)\n    mask = (d <= self.upper_radii) * (d >= self.lower_radii)\n    d = d[mask]\n    assert_equal(len(b[i]), len(d))\n    assert_almost_equal(b[i], sorted(d), decimal=14)\n"
}