{
    "functionName": "test_basic3D",
    "className": null,
    "fileName": "/CCampJr_&_CRIkit2/crikit_&_cri_&_tests_&_test_pec.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "x = np.linspace(-100, 100, 1000)\nphi_peak = 10 * np.imag(1 / (25 - x - 1.0j * 2))\nphi_bg = np.exp(-x ** 2 / (2 * 30 ** 2))\nphi = phi_peak + phi_bg\ny = 1 * np.exp(1.0j * phi)\ny = np.dot(np.ones((9, 1)), y[(None), :]).reshape((3, 3, -1))\nassert np.sum((phi_peak - phi) ** 2) > 265.0\npec = PhaseErrCorrectALS(smoothness_param=1, asym_param=1e-08, redux=1,\n    fix_end_points=False, fix_rng=None, verbose=True, use_prev=False)\ny_pec = pec.calculate(y)\nphi_pec = np.unwrap(np.angle(y_pec))\nnp.testing.assert_array_less(np.sum((phi_peak - phi_pec) ** 2, axis=-1), 4.7)\n"
}