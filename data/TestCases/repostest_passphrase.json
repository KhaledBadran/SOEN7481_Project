{
    "functionName": "test_passphrase",
    "className": "TestTrezorManCommands",
    "fileName": "/bitcoin-core_&_HWI/test_&_test_trezor.py",
    "projectName": "repos",
    "Label": false,
    "isTest": true,
    "Body": "self.do_command(self.dev_args + ['togglepassphrase'])\nresult = self.do_command(self.dev_args + ['enumerate'])\nfor dev in result:\n    if dev['type'] == 'trezor' and dev['path'] == 'udp:127.0.0.1:21324':\n        self.assertTrue(dev['needs_passphrase_sent'])\nresult = self.do_command(self.dev_args + ['-p', 'pass', 'enumerate'])\nfor dev in result:\n    if dev['type'] == 'trezor' and dev['path'] == 'udp:127.0.0.1:21324':\n        self.assertFalse(dev['needs_passphrase_sent'])\n        fpr = dev['fingerprint']\nif self.emulator.model_t:\n    result = self.do_command(self.dev_args + ['-p', 'pass2', 'enumerate'])\n    for dev in result:\n        if dev['type'] == 'trezor' and dev['path'] == 'udp:127.0.0.1:21324':\n            self.assertFalse(dev['needs_passphrase_sent'])\n            self.assertEqual(dev['fingerprint'], fpr)\nelse:\n    result = self.do_command(self.dev_args + ['-p', 'pass2', 'enumerate'])\n    for dev in result:\n        if dev['type'] == 'trezor' and dev['path'] == 'udp:127.0.0.1:21324':\n            self.assertFalse(dev['needs_passphrase_sent'])\n            self.assertNotEqual(dev['fingerprint'], fpr)\nself.client.call(messages.Initialize())\nresult = self.do_command(self.dev_args + ['-p', 'pass3', 'enumerate'])\nfor dev in result:\n    if dev['type'] == 'trezor' and dev['path'] == 'udp:127.0.0.1:21324':\n        self.assertFalse(dev['needs_passphrase_sent'])\n        self.assertNotEqual(dev['fingerprint'], fpr)\nself.do_command(self.dev_args + ['togglepassphrase'])\nresult = self.do_command(self.dev_args + ['enumerate'])\nfor dev in result:\n    if dev['type'] == 'trezor' and dev['path'] == 'udp:127.0.0.1:21324':\n        self.assertFalse(dev['needs_passphrase_sent'])\n        self.assertEquals(dev['fingerprint'], '95d8f670')\nresult = self.do_command(self.dev_args + ['-p', 'pass', 'enumerate'])\nfor dev in result:\n    if dev['type'] == 'trezor' and dev['path'] == 'udp:127.0.0.1:21324':\n        self.assertFalse(dev['needs_passphrase_sent'])\n        self.assertEquals(dev['fingerprint'], '95d8f670')\n"
}